---
title: "Hierarchical Ordination, A unifying framework for drivers of community processes"
subtitle: "Running Title: Hierarchical Ordination"
author: 
  - R.B. O'Hara$^{12} bob.ohara@ntnu.no Tel: +47 91554416$
  - B. van der Veen$^{123} bert.v.d.veen@ntnu.no$
date: $^1$Department of Mathematical Sciences, Norwegian University of Science and Technology, Trondheim, Norway \newline $^2$Centre of Biodiversity Dynamics, Norwegian University of Science and Technology, Trondheim, Norway \newline $^3$Department of Landscape and Biodiversity, Norwegian Institute of Bioeconomy research, Trondheim, Norway \newline
output: pdf_document
header-includes:
   -  \usepackage[left]{lineno}
   -  \usepackage{setspace}\doublespacing
   -  \linenumbers
   - \usepackage{tikz}
   - \usetikzlibrary{shapes,snakes}
   - \tikzstyle{mybox} = [draw=gray, very thick, rectangle, rounded corners, inner sep=10pt, inner ysep=10pt]
   - \tikzstyle{fancytitle} =[text=black]
   - \usepackage{multicol}
   - \usepackage{caption}
   - \usepackage{subcaption}
   - \usepackage{float}
bibliography: references.bib
biblio-style: methods-in-ecology-and-evolution.csl

nocite: |
  @Ribera2001
---

```{css, echo=FALSE}
table, th, td {
  border: 1px solid;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

GetWC <- function(RMD) {
  Strng <- paste(readLines(con=RMD), collapse = "\n") # Makr one line
  WC <- gsub(".*---", "", Strng)
  lengths(strsplit(WC, ' '))
}
# AbstractWC <- readLines(con="Abstract.Rmd")
# # lengths(strsplit(AbstractWC[8], ' '))
# 
# TextBoxWC <- paste(readLines(con="TextBox.Rmd"), collapse = "\n") # Makr one line
# TextBoxWC <- gsub(".*---", "", TextBoxWC)
# # lengths(strsplit(TextBoxWC, ' '))

```

**Article Type:** Methods

**Word Count:** Abstract: `r GetWC("Abstract.Rmd")`. Main text: `r as.integer(sub("(\\d+).+$", "\\1", system(sprintf("wc -w %s", knitr::current_input()), intern = TRUE))) - 20`. Text Box: `r GetWC("TextBox.Rmd")`

**Number of references:** 37

**Number of figures, tables, and text boxes: ** 1 figure, 0 tables, 1 text box


**Statement of authorship:** Usually a manuscript with a student and their supervisor comes about when the supervisor has a brilliant idea, but doesn't have time, so the student has to do all of the hard work, trying to find out if the idea actually works and doing the writing. In this manuscript, the roles were reversed. Neither author is totally sure how it happened.

**Data accessibility statement:** The data are available on figshare (DOI: 10.6084/m9.figshare.c.3297428.v1), as well as in the GitHub repository for this manuscript (https://github.com/oharar/HierarchicalOrdination).


\newpage

## Abstract

```{r test, child="Abstract.Rmd", eval=TRUE}
```

Keywords: Ordination, JSDM, GLLVM

\newpage

## Introduction

Community ecology is the study of groups of species. One important set of questions relate to how and why species are distributed relative to each other. For example, do particular species tend to occur together, and can this be explained by similar responses to the environment. These same questions can be asked across different scales, e.g. looking at samples from different Dutch sand dunes [@batterink1983een], or the complete distributions of different species across the globe. Statistical methods have been developed to look at this type of data for both of these scales, but their similarities have not been widely appreciated.

The methods we consider in this article assume that species are observed at a number of sites, so the data is a site by species matrix, with entries being a measure of abundance or incidence, e.g. whether a species was observed at that site, or the number of individuals observed. Historically, these data have been summarised by **ordination methods** [e.g. @Gower1966; @terBrakk1985], which look to reduce the variation in data to a small number (usually two) of dimensions. This means that sites and species can be plotted on an **ordination diagram**, which can be inspected visually [@gabrielBiplotGraphicDisplay1971]. More recently, approaches have been developed that are based on modern statistical modelling ideas, leading to the application of Generalised Linear Latent Variable Models in community ecology [@HuiGLLVMs2015;@skrondalGeneralizedLatentVariable2004].

Species distribution models (SDMs) were developed to predict the incidence of species with environmental variables. The perceived importance of interactions between species [@Wisz2013; @Kissling2012] suggested that their distributions should be modelled jointly. This lead to the development of Joint Species Distribution Models [JSDMs: @Pollock2014], which also model the response of each species to the environment, but then incorporate a correlation matrix to allow for covariance between species. It was quickly realised that this matrix becomes unmanageable for many species, as it has so many parameters to estimate. Thus, extensions were developed to model the matrix as the sum of a smaller set of linear effects [e.g. @Warton2015; @Ovaskainen2017]. Because these models are based on a formal probabilistic model (which can be written as a likelihood, and thus fitted to data with flexible statistical methods), they have been extended in a variety of directions (see below). 

The differences in the ways that ordination and JSDMs have been used largely revolve around the aims of the data collection and analysis. Ordination has typically been used for small scale field studies that describe the differences between communities they have sampled at different sites or times, and possibly look at how these differences are related to environmental variables [e.g. such as @bray1957ordination]. Thus the focus has been on exploration of the relationships between species and communities. In contrast, JSDMs were developed by and for macro-ecologists, wanting to look at the distributions of species over their whole range, with the primary aim of estimating the effects of environmental covariates on the distribution of species, and thus being able to predict their current and future distributions [@clark2014more]. The role of the residual correlation was to improve the predictions, rather than be interpretable: problems with interpreting the correlations as interactions between species were pointed out early on [@Pollock2014].

Thus, JSDMs tend to focus on a larger spatial scale, and more emphasis is placed on understanding the effects of covariates. As a practical matter, they are also generally based on binary observations [but see @Bjork2018 for a counter-example], whereas ordination has been carried out on a wider range of data, and typically at a smaller spatial scale. Despite these differences, the underlying idea - to reduce covariation down to a smaller number of dimensions - is the same. Our aim here is to outline the similarities between the two approaches, and to suggest that each can learn from the other. We then suggest a scheme to flexibly extend these methods without making them too unwieldy.

## The Models

In order to look at the similarities between ordination and JSDMs, we first need to have a common framework. We will thus first develop a simple example of model-based ordination and JSDMs, and use this to explain the more complex models that have been developed.

In the simplest case, the data are a matrix, with rows being sites, and columns being species. The entries are observations of the species, which can take several forms, e.g. counts, percent cover, or (particularly for JSDMs) species' presence/absence. In addition to this, we can have covariates which are associated with the rows or columns, such as measures of the environment (temperature, habitat etc.) for each site, or traits (size, diet etc.) for each species. 

We can create a straightforward model for this data. Each observation of species $j$ ($j=1,\dots, p$) at site $i$ ($i=1,\dots, n$) is denoted $y_{ij}$. We call the full matrix of observations $\textbf{Y}$. We can model $\textbf{Y}$ as an extension of a generalised linear model, with $g\{E(y_{ij})\} = \eta_{ij}$, where $g(\cdot )$ is a link function (e.g. logit or cloglog for binary observations). On the link scale we model the expected value of each datum as

\begin{equation}
\eta_{ij} = \alpha_i + \phi_j + \varepsilon_{ij},
\end{equation}

where $\alpha_{i}$ is the effect for site $i$, $\phi_{j}$ is an effect of species $j$, and where $\varepsilon_{ij}$ is an error term. The error ensures that we incorporate the correlation between species [@Pollock2014]:

\begin{equation}
\boldsymbol{\varepsilon}_{i} \sim MVN(\mathbf{0}, \boldsymbol{\Lambda}),
\end{equation}

where $\boldsymbol{\Lambda}$ is a $p \times p$ covariance matrix, with off-diagonal terms being the covariances. The number of parameters in $\boldsymbol{\Lambda}$ increases quadratically with the number of species, which makes the matrix difficult to estimate for large $p$, and the large number of parameters also makes the matrix difficult to interpret. The ordination/JSDM approach to handling this is to write the matrix as the sum of a product of row- and column- effects. Each product defines one of $L$ *latent dimensions*.  The model is then

\begin{equation}
\eta_{ij} = \alpha_i + \phi_j + \sum \limits^L_{l=1} z_{il} \gamma_{jl}.
\end{equation}

In ordination, $z_{il}$ is called a site score (i.e. a site its location on the latent variable), and $\gamma_{jl}$ is called a species loading. We can interpret $z_{il}$ as a location along gradient $l$, or informally that there are $L$ unobserved covariates, with $\gamma_{jl}$ being the regression parameter for the effect of covariate $l$ on species $j$. The scale is arbitrary, so it is convenient to scale the site scores so that $\text{var}(z_{il})=1$. then the covariance between species one and two becomes $\sum_{l=1}^{L}\gamma_{1l} \gamma_{2l}$. 

There are several technical issues that have to be dealt with when fitting this model, for example with two or more latent variables, the site scores are axes that can be rotated, so some constraints are needed so that a unique solution can be found (i.e. to make the model identifiable). However, we will not delve into these details further here.

This is the basic model that has been developed for both JSDMs and ordination (as a GLLVM). As described below, it can be extended in many ways, by including further effects for the sites, species and latent effects, i.e. $\alpha_i$, $\phi_j$, $z_{il}$, and $\gamma_{jl}$. 

### Adding Covariates

The model described above projects the correlation matrix down into $L$ dimensions, where $L$ is relatively small. But, as written, it does not include covariates. There are several ways to add them: for example, @Ovaskainen2017
outlined an approach where they incorporate covariates for species and sites respectively, i.e. we could use a model such as:

\begin{equation}
\eta_{ij} = \sum \limits^{K}_{k=1} \beta_{jk}X_{ik} + \sum \limits^{S}_{s=1}\theta_{is}W_{js}  + \sum \limits_{l=1}^L z_{il} \gamma_{jl},
\end{equation}

where there are $K$ site-level covariates (e.g. climate variables), and $S$ species-level covariates (e.g. traits). The model is a sum of several terms, each of which is the product of a species and site term. The differences are whether the terms are known (i.e. covariates) or have to be inferred from the model. So the model incorporates responses of species to environmental conditions, as well as the effects of species' characteristics on their site response.

The regression coefficient matrices $\mathbf{\beta}$ and $\mathbf{\theta}$ can become large if there are many covariates, so some way to reduce this is desirable. This is simply a variable selection problem, for which there are several solutions available, through either selecting which variables are "in" and "out", or some form of regularisation [e.g. @OHaraSilanpaa for some Bayesian methods; or @TredennickSelectModels for some non-Bayesian approaches]. 

Random effects can also be added. This can be interpreted as simply putting a covariance structure on some of the $\beta_{jk}$'s or $\theta_{is}$'s. For example, a phylogenetic effect can be added by having a $\theta_{is}$ for each species, but forcing a phylogenetic correlation, i.e. species with a more recent common ancestor tend to have more similar values of $\theta_{is}$.

Classical ordination takes a different approach to including covariates. Instead of the site main effects being modeled, covariates are included through **constrained ordination** [e.g. @terBraak86CCA], where the site scores of the latent variables are forced to be linear functions of covariates

\begin{equation}
z_{il} = \sum_{k=1}^K X_{ik} \psi_{kl}.
\end{equation}

This implies that the latent variables are fully explained by the observed covariates. @vanderVeen2021 extended this approach to allow a latent variable to be affected by covariates, plus additional (unobserved) effects:

\begin{equation}
z_{il} = \sum_{k=1}^K X_{ik} \psi_{kl} + \varepsilon_{il}.
\end{equation}

This assumes that the gradient is affected by (or, at least, correlated with) measures of the environment. Again, random effects can also be added, in particular the gradient can be modelled spatially as a continuous field, leading to a type of **spatial factor analysis** [@Thorson2015], where communities that are closer to each other tend to have more similar site effects. In essence, both fixed and random effects can be used to put structure on $z_{il}$. Another variation on this is to use more than one set of latent variables, with some responding to the environment, and others being unconstrained. For example, @Bjork2018 modelled host-associated microbiota by including separate ordinations for the host species and the samples (within host species). 

The **response** of a species to the gradient can also be modelled as being affected by the environment [e.g. @Tikhonov2017; @Perrin2021]:

\begin{equation}
\gamma_{ijl} = \sum \limits_{k=1}^K X_{ik} \psi_{jkl}.
\label{eq:EnvCor}
\end{equation}

This allows the species effect to depend on the environment, so that the covariance between species $j$ and $h$ on site $i$ is proportional to $\sum_{k=1}^K X_{ik} \psi_{jkl}\psi_{hkl}$, i.e. is a linear function of the covariate. This allows the correlation to change across environments, and potentially change sign.

# Learning From Each Other

Within the development of the GLLVM framework, we can see that JSDMs and model-based ordination are equivalent mathematically. The biological differences stem from the data and the questions being asked. Ordination has typically looked at a set of sites that have been sampled, and asks about the similarities between the communities on these sites. JSDMs, in contrast, try to model and predict the distributions of the species across their whole ranges, i.e. they are interested in the full distributions of the species, and are not interested in characterising the sites themselves. So for ordination, the focus is on the relationship between communities and sites, whereas JSDMs are primarily intended to predict the distribution of each species: the covariance between species is mainly of interest because it changes the predictions for each species [@Wilkinson2021]. 

The equivalence between ordination and JSDMs suggests that each area should be able to help the other. At the conceptual level, the questions being asked in the ordination world can also be asked by the SDM world, opening up the possibility of modelling the distributions of ecosystems. Most usefully, the methods and theory developed in one area can be transferred across and used in the other.

## What can JSDMs learn from Ordination?

The focus of ordination has usually been on the whole community, rather than looking at individual species. Because of this, the typical summaries are visualisations, i.e. ordination plots, which efficiently condense information from sites and species into figures. In an ordination diagram, sites that are negatively correlated are located far away from each other, and species that are predicted to co-occur will be close together in the figure. These can thus help with understanding co-occurrence patterns, and help to guide further modelling and interpretation (e.g. if several species cluster together). Using ordination plots into the analysis of JSDM should thus help with summarising and interpreting the correlations between species and sites.

The ecological interpretation of ordinations is also more advanced. If the ordination axes are interpreted as ecological gradients, then the site scores represent the predicted locations of sites on the gradient, and the species loadings can (in some models) be the species' optima. Thus the ordination axes can be interpreted as part of the species's niche. Ecologically, the development and application of ordination methods has been motivated by the species packing model [@JamilterBraak2013], where each species has an equal tolerance to the gradient. Adding a quadratic term in the ordination can relax the equal tolerance assumption, so species can be generalists or specialists with respect to the gradient [@vanderVeenQuadratic]. On top of this, a constrained ordination can be used to efficiently model the niches of many species together. This will be useful when a large number of species are being considered, e.g. from meta-barcoding data, and particularly when properties of the whole community, rather than of each species, will be important.

## What can Ordination learn from JSDMs?

Ordination can take advantage of the flexibility of the modelling framework, which has been developed more fully in the JSDM world. As described above, @Ovaskainen2017 developed a framework to incorporate a wide range of effects on both the species and sites, which can potentially incorporate spatial effects [@tikhonov2020computationally]. The statistical modelling framework that has been used in the development of JSDMs is explicitly linear, which it straightforward to write down models with extra effects. Although fitting these models may not be easy, software has been developed to fit these models [@Ovaskainen2017; @Nikugllvm], and extensions beyond these can be developed using flexible Bayesian packages such as JAGS [@JAGS] and Nimble [@Nimble2017].

The JSDM approach also helps with incorporating better sampling models [e.g. @Beissinger2016; @Bjork2018; @Tobler2019], so that issues like pseudo-replication can be handled by properly incorporating their effects into the model. For example, multiple traps or visits at a site can be treated as replicate samples from the same community: with binary data this can be used in an occupancy model [@Tobler2019], but when the data estimate abundance (e.g. through counts), the repeated samples can be used to estimate the amount of sampling error. These models can be extended to include observation-level covariates, in the same way that they are in occupancy models.

Another area where ordination can follow methods developed in the JSDM world is the use of temporally explicit models. Because the approach is based on an explicit model, it can include a temporal autocorrelation [e.g. @BjorkPreprint; @OvaskainenTimeSeries]. This is preferable to the approach that classical ordination takes, where the order of the years is ignored in the ordination, although it can be incorporated into the graphical presentation [e.g. @BLANCHETTE2013]. This links the temporal changes more directly to models of community dynamics, as it is a multi-species Gompertz model where environmental effects on growth rates can be incorporated [e.g. @Mutshinda2011]. 

# Hierarchical Ordination; a unifying framework for drivers of community processes

The GLLVM framework is flexible enough to be developed in several directions. Site scores have already been modelled as a function of covariates, through a concurrent GLLVM [@vanderVeen2021], and also as a spatial field (allowing for spatial autocorrelation), in a spatial factor analysis [e.g. @Thorson2015]. But species effects, such as traits or phylogenetic effects, could be modelled instead, simply by transposing the data matrix. Ordination can thus be linked to trait-based analyses.

In the fixed effects, estimating the interactions between site and species covariates are the "fourth corner problem". This can be parameter heavy when there are several covariates [e.g. see @Niku2021 in the context of GLLVMs]. One possible approach is to extend the constrained ordination idea, so that both site scores and species loadings are modelled further. This leads us to the idea of what we have called hierarchical ordination, an extension of double constrained ordination [@Ter_BraakdcCCA]. As before we have

\begin{equation}
\eta_{ij} = \alpha_i + \phi_j + \sum \limits_{l=1}^L z_{il} \gamma_{jl}.
\end{equation}

But now we extend the models for both $z_{il}$ and  $\gamma_{jl}$:

\begin{equation}
z_{il} = \sum\limits_{k=1}^K X_{ik} \psi_{kl} + \varepsilon_{il};
\end{equation}

and

\begin{equation}
\gamma_{jl} = \sum \limits_{s=1}^S W_{js} \delta_{sl} + \epsilon_{jl}.
\end{equation}

Because both $z_{il}$ and $\gamma_{jl}$ can be written as sums of other terms, it is straightforward model them both hierarchically, as we would for any other hierarchical model. For example, a spatial effect can be added to the site scores, similar to the spatial factor analysis idea, but trait and phylogenetic effects can also be added to the species loadings. The method developed by @Ter_BraakdcCCA is similar, but they assume $z_{il} = \sum\limits_{k=1}^K X_{ik} \psi_{kl}$ and $\gamma_{jl} = \sum \limits_{s=1}^S W_{js} \delta_{sl}$, i.e. the site scores and species effects are fully determined by the covariates.

We can also standardise $z_{il}$ and $\gamma_{jl}$ so each has a variance of one, and then introduce a matrix of scaling parameters $\boldsymbol{\Lambda}$. The main diagonal of this matrix can be interpreted in the same way as an singular values in classical ordination: it summarises how much of the variation can be explained by that latent variable. Typically all of the values off the main diagonal would be zero, although this is not necessary: off-diagonal terms would mean that the latent variables are correlated. Consequently, hierarchical ordination is more similar in form to classical ordination methods than existing model-based ordination methods.

Expanding the model, we get 

\begin{equation}
\begin{split}
\eta_{ij} &= \alpha_i + \phi_j + (\boldsymbol{x}_{i}^\top \boldsymbol{\psi} + \boldsymbol{\varepsilon}_{i}^\top)\Lambda(\boldsymbol{\delta}^\top\boldsymbol{w}_{j} + \boldsymbol{\epsilon}_{j}) \\
&         = \alpha_i + \phi_j +
\boldsymbol{x}_{i}^\top \boldsymbol{\psi} \Lambda \boldsymbol{\delta}^\top\boldsymbol{w}_{j} +
\boldsymbol{\varepsilon}_{i}^\top \Lambda \boldsymbol{\delta}^\top\boldsymbol{w}_{j} + 
\boldsymbol{x}_{i}^\top \boldsymbol{\psi} \Lambda \boldsymbol{\epsilon}_{j} + 
\boldsymbol{\varepsilon}_{i}^\top \Lambda \boldsymbol{\epsilon}_{j}.
\end{split}
\end{equation}


This model acts as an reduced version for the fourth corner latent variable model because it incorporates trait by environment interactions through the latent variables. Going through the ordination terms in, scalar notation, we have 

- $\boldsymbol{\Lambda}$: the variance of the latent variable (on the link scale), similar to singular values i classical ordination
- $\boldsymbol{x}_{i}^\top \boldsymbol{\psi} \Lambda \boldsymbol{\delta}^\top\boldsymbol{w}_{j} = \sum \limits^d_{q=1}\sum \limits^p_{k=1}x_{i,k} \psi_{k,q} \Lambda_{q,q} \sum \limits^{tr}_{t=1}\delta_{t,q}w_{j,tr}$: the fourth-corner term approximated in reduced rank, or a double constrained ordination
- $\boldsymbol{\varepsilon}_{i}^\top \Lambda \boldsymbol{\delta}^\top\boldsymbol{w}_{j} = \sum \limits^d_{q=1}\varepsilon_{i,q} \Lambda_{q,q}\sum \limits^{tr}_{t=1} \delta_{t,q}w_{j,t}$: a constrained ordination where the species loadings are constrained by traits alone
- $\boldsymbol{x}_{i}^\top \boldsymbol{\psi} \Lambda \boldsymbol{\epsilon}_{j} = \sum \limits^d_{q=1}\sum \limits^p_{k=1} x_{i,k}\psi_{k,q}\Lambda_{q,q}\epsilon_{j,q}$: a constrained ordination with site effects determined by environmental covariates
- $\boldsymbol{\varepsilon}_{i}^\top \Lambda \boldsymbol{\epsilon}_{j} = \sum \limits^d_{q=1}\varepsilon_{i,q}^\top \Lambda_{qq} \epsilon_{j,q}$: a residual ordination

Each of which would have a different place in the analysis of co-occurrence patterns in ecological communities. Of course, these terms can also include structured random effects, e.g. spatial or phylogenetic.

Another way to look at this model is that it can model the change in associations between species with the environment [@Tikhonov2017; @Perrin2021]. This comes from the fourth corner term, which models the interaction between traits and environment, so plays the same role as equation \eqref{eq:EnvCor}. 

One advantage of having an explicit hierarchical ordination framework is that visualisation and interpretation can be based on current ordination methods, for example ordination diagrams can be drawn for both site and species effects. Thus the advantages of ordination as a way of summarising correlation, and the effects of covariates on the correlations, are retained with this model.

There may be problems where a single hierarchical ordination is not sufficient. For example, an additional species-specific covariate effect may be needed, leading to this model:

\begin{equation}
\eta_{ij} = \alpha_i + \phi_j + \sum_{k=1}^K X_{ik} \beta_{jk} + \sum_l^L z_{il} \gamma_{jl}.
\end{equation}

Potentially, more than one ordination could also be used [@Bjork2018], so the framework is flexible, at the cost (both computationally and in terms of interpretation) of adding extra latent levels. Using a single ordination, with effects on either species or sites, we simplify the model into manageable parts. The choice of whether to use one or two (or more!) sets of ordination will depend on whether a single ordination is reasonable ecologically, and whether multiple ordinations are feasible computationally. Whilst the complexity of additional ordinations is attractive, the price is that more data will be needed to estimate the parameters of the model, and the fitting will be more difficult.

<!-- Definebox and box title style-->
\begin{tikzpicture}
\node [mybox] (box){%
\begin{minipage}{\textwidth}

```{r test, child="TextBox.Rmd", eval=TRUE}
```

\begin{figure}[H]
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{sites.png}
  \caption{Sites plot with environmental effects.}
  \label{fig:sub1}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{species.png}
  \caption{Species plot with traits effects.}
  \label{fig:sub2}
\end{subfigure}
\caption{Visualization of the hierarchical ordination for the beetle data. Note, that the environmental effects could have been plotted in the species plot, or the trait effects in the sites plot, instead.}
\label{fig:test}
\end{figure}
\end{minipage}
};
\node[fancytitle, right=8pt, yshift=5pt] at (box.north west) {\textbf{An example of hierarchical ordination}};
\end{tikzpicture}

# Discussion

We have discussed how ordination and JSDMs have converged onto a similar set of models, GLLVMs, providing a common framework that is available to both groups of ecologists. The differences between the two approaches largely came from scale and the questions being asked, but the models are flexible enough to handle these. Having a single set of models should help to unify these different approaches to community ecology, and the link to temporal models should improve connections to ecological theory, efficiently integrating data into the frameworks that are being developed.

A model-based approach allows for a lot of flexibility, as we can see in our overview. One downside of this flexibility is the possibility that the model becomes too complex to be interpretable. With a large number of species and sites, it is easy to develop models that ask for all of this information to be used. Our suggestion of a hierarchical approach to ordination tries to reduce this complexity by making the parameters either site- or species- specific. Interactions between the two sets of parameters are made through the latent variables. This is one simplification of the model, so the response of a community to changes in the environment are measured by how the site scores change, and then how this affects species, through their loadings. This shifts focus from individual species or sites to the community, and the gradients. 

It is one thing to write down a model, but another to fit it. For "power users" flexible software, like Nimble [@Nimble2017], which takes advantage of the flexibility and simplicity of the BUGS language, can be used to develop and extend these models. The example shown here was fitted with Nimble, and the code is available in the Supporting Information. But for most ecologists it would be better to have bespoke software, which would mean developing packages like HMSC [@Ovaskainen2017] and gllvm [@Nikugllvm] to fit models in the full framework.

We would not want to suggest that every ordination should use this framework: there will be times when the question being asked requires a different model. However, we feel that our framework is sufficiently flexible for many problems, and will build on both the modelling strengths developed from JSDMs and the visualisation and interpretation provided by the ordination world^[a world that is, of course, only two dimensional]. If extensions are needed, we would suggest that our model provides a starting point, both in terms of writing down the extended model and also in justifying why such an extension is needed. For example, when @Bjork2018 used two ordinations to model two levels of sampling, a natural question is whether it would have been better to use one ordination, with sample and host species levels in the site effects, and with the same species loading. The answer to this question is not just one of modelling, it is also ecologically informative, i.e. about the extent to which species were responding to hosts, or to site effects.

Though the modeling framework suggested here is statistical in nature, this approach can serve to provide new insight into ecological theories on community assemblages. Further extensions of the framework towards spatiotemporal processes can serve to develop a theoretical model for how species interact in space and time, and how species-specific properties relate to site-specific properties, as in the case of functional traits.

The modelling of multispecies communities is being changed by the application of more sophisticated statistical techniques. Here we are suggesting that they can unify different fields, as they are modelling similar processes, and so can open up the fields to new questions. This is done both by moving ideas from one field to another (e.g. using ordination plots in JSDMs), and also by opening up new ways of analysing the data, with flexible models that can handle the problems associated with having many sites and species. To quote one of the world's great philosophers, [let's go exploring](https://www.gocomics.com/calvinandhobbes/1995/12/31) [@CalvinHobbes].


# References